<!DOCTYPE HTML>
<html>
<head>
<style>
	html, body {
	  width:  100%;
	  height: 100%;
	  margin: 0;
	  overflow: hidden;
	}
</style>
<script type="text/javascript" src="math.js"></script>
<script type="text/javascript" src="canvas_engine.js"></script>
<script type="text/javascript">
var canvas;
var ctx;
var time = 0;
//=========================================================================================== Tu cÃ³digo aqui

var TECLA_W = 87
var TECLA_S = 83
var TECLA_A = 65
var TECLA_D = 68
var TECLA_UP = 38
var TECLA_DOWN = 40
var TECLA_LEFT = 37
var TECLA_RIGHT = 39

function Objeto(marcoDeReferencia)
{
	var m = {
		marco: marcoDeReferencia,
		x: 0,
		y: 0,
		_vx: 0,
		_vy: 0,
		_ax: 0,
		_ay: 0,
		set vx(newvx) {
			this._vx = newvx;
		},
		get vx() {
			return this.marco==null ? this._vx : this._vx+this.marco.vx;
		},
		set vy(newvy) {
			this._vy = newvy;
		},
		get vy() {
			return this.marco==null ? this._vy : this._vy+this.marco.vy;
		},
		set ax(newax) {
			this._ax = newax;
		},
		get ax() {
			return this.marco==null ? this._ax : this._ax+this.marco.ax;
		},
		set ay(neway) {
			this._ay = neway;
		},
		get ay() {
			return this.marco==null ? this._ay : this._ay+this.marco.ay;
		},
		move: function() {
			this.vx = this._vx+this.ax*elapsed_time;
			this.vy = this._vy+this.ay*elapsed_time;
			this.x = this.x+this.vx*elapsed_time+0.5*this.ax*elapsed_time*elapsed_time;
			this.y = this.y+this.vy*elapsed_time+0.5*this.ay*elapsed_time*elapsed_time;
		}
	}

	return m
}

var plataforma = new Objeto();
var auto = new Objeto(plataforma);
var jugador = new Objeto(auto);

var velplat = 60;

function Start()
{
	plataforma.vx = velplat;
	plataforma.y = 200;
	auto.y = 300;
	auto.x = 100;
	jugador.x = 150;
	jugador.y = 350;
}

function Update()
{
	if (plataforma.x > screenWidth-600) {
		plataforma.vx = -velplat
	}
	if (plataforma.x < 0) {
		plataforma.vx = velplat
	}

	auto.vx = 0
	auto.vy = 0
	var autospd = 80
	if (IsKeyPressed(TECLA_W)) {
		auto.vy = -autospd;
	}
	if (IsKeyPressed(TECLA_S)) {
		auto.vy = autospd;
	}
	if (IsKeyPressed(TECLA_D)) {
		auto.vx = autospd;
	}
	if (IsKeyPressed(TECLA_A)) {
		auto.vx = -autospd;
	}

	jugador.vx = 0
	jugador.vy = 0
	var jugadorspd = 80
	if (IsKeyPressed(TECLA_UP)) {
		jugador.vy = -jugadorspd;
	}
	if (IsKeyPressed(TECLA_DOWN)) {
		jugador.vy = jugadorspd;
	}
	if (IsKeyPressed(TECLA_RIGHT)) {
		jugador.vx = jugadorspd;
	}
	if (IsKeyPressed(TECLA_LEFT)) {
		jugador.vx = -jugadorspd;
	}

	plataforma.move();
	auto.move();
	jugador.move();
}

function Render()
{
	DrawRectangle(0,0,screenWidth,screenHeight,0,0,0,1)

	DrawRectangle(plataforma.x, plataforma.y, 600, 600, 255, 255, 0, 1)
	DrawRectangle(auto.x, auto.y, 100, 100, 0, 0, 255, 1)
	DrawCircle(jugador.x, jugador.y, 10, 255, 0, 0, 1)
}

//===========================================================================================
</script>
</head>
<body onload="Initialize();">
	<canvas id="mycanvas" width="1200" height="800"></canvas>
</body>
</html>
 
